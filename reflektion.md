# Tabellreflektion för namngivning

| Name                      | Explanation                                                                      | Reflection and rules from Clean Code                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ------------------------- | -------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| LineChart.autoFitViewport | Method to automatically change the viewport of the chart to fit all chart lines. | **Method Names** - Methods should contain a verb, in this case "fit". **Use Solution Domain Names** - The word "viewport" is a technical term in computer graphics referring to an area that is currently being viewed. In this instance it refers to the area where the lines are being rendered. **Use Problem Domain Names** - The problem domain name could have been something along the lines of `autoFitPlotArea()`, but in my opinion "autoFitViewport" is a suitable solution domain name and therefore we will prefer it over the problem domain name to more easily communicate with future programmers working on this code. |
| Polyline                  | Class name for a set of points together creating a line.                         | **Avoid Disinformation** - Originally, I considered calling this class `Line`, but I decided against it because the word line usually refers to just a single, straight line intersecting two points. Polyline better describes that the class actually represents a set of line segments joined together end to end. **Make Meaningful Distinctions** - Internally, the module also uses a `LineSegment` class. For this reason it is extra important to distinguish between a `Polyline` and a `LineSegment`. Calling one of those `Line` instead would be very confusing. **Class Names** - Classes should have a noun as their name. |
| Polyline.thickness        | Property determining the thickness of the line in pixels.                        | **Don't Add Gratuitous Context** - The property is already in the `Polyline` class, so it is clear that it refers to the thickness of the line. Calling it `lineThickness` would be redundant.                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| LineChart.setViewport     | Method to set the viewport of the chart area.                                    | **Pick One Word per Concept** - At first I mixed the terms "viewport" and "chart area". Using "chart area" internally at first and then adding the public `setViewport` method. I have changed the internal "chart area" variable names to instead say "viewport" for consistency.                                                                                                                                                                                                                                                                                                                                                       |
| LineChart.axisInterval    | Setter to set the target interval between ticks on the chart axes.               | **Use Problem Domain Names** - Originally, I called this setter `scaleInterval`, but have now changed it to `axisInterval` which is closer to the problem domain. The problem domain name for this is perfectly adequate and well understood by everyone. There isn't a reason to use a solution domain name instead. **Avoid Disinformation** - As the name is now, you may not immediately think of the interval between axis ticks. It would be a good idea to change it to something like `axisTickInterval` to clarify that it refers to the interval between axis ticks specifically.                                              |

# Kapitelreflektion kap 2

The book states in **Method Names** that "Accessors, mutators, and predicates should be named for their value and prefixed with get, set, and is according to the javabean standard.". I don't believe this should apply to javascript, because of the way accessors and mutators are written. In javascript you should instead write `get name()` or `set name(value)` which can be called via the object as a property like `object.name = "Jane Doe"`. Further, naming your getters and setters like this, will prevent you from naming any other member variables with the same name. If you were coding in java, for example, you would name your member variable `name` and your getter `getName()`, but this would not be possible in javascript using the `get name()` style getter. For this reason, I would argue that the book's **Avoid Encodings** rule doesn't apply in this case, and that it would be suitable to, for example, include an underscore prefix before private member variables that have a corresponding getter or setter. This is the way I have done it in my code, and while there may be some downsides to this approach, I believe it is a good compromise to avoid naming your private member variables something completely different than their public getter or setter. This way, you can still clearly see the connection between the private member variable and its public accessor or mutator.

I would have liked to potentially use static methods as overloaded constructors. For example, in the `Color` class, I could have had a static `fromRGB(red, green, blue): Color` constructor method. This is also endorsed by the book in **Method Names**, but the assignment explicitly forbids static methods.

In the `RectangleMapper` class I previously had variables with the placeholder names `foo`, `bar` and `baz`. This breaks against **Use Intention-Revealing Names**. I have now replaced them with `relativeToSource`, `scaledToTarget`, and `mappedToTarget` to reflect the three steps for mapping a point from the reference frame of the source rectangle to the target rectangle. I also renamed the method from `map()` to `mapPoint()`, because I now also have other methods in the class named `mapRectangle()` and `mapLineSegment()`. A single `map(point)` would be fine if it was the only method, since the argument name tells you what exactly is being mapped, but with multiple `map` methods, it is better to be more descriptive.

# Tabellreflektion för funktioner/metoder

| Method name       | Link or code                                                                                                                                     | Number of rows | Reflection                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------ | -------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| drawGridLine      | [Link to code](https://github.com/ij222pv/line-chart/blob/b0f67f141fad198fb477fdd02d64fd8aeb015ef1/src/renderers/LineChartRenderer.ts#L271-L293) | 18             | **One Level of Abstraction per Function** - This method mixes levels of abstraction. It sets the color to use directly, and then calls another function to do the actual rendering. It would be better to raise the abstraction to the same level by calling another method to set the color. Also the positions of the points where the line will be drawn could be calculated in a separate method in order to properly raise the abstraction to the same level. **Do One Thing** - This method does a number of things. It sets the color, calculates the position of the line, and draws the line. This should be broken down into multiple smaller methods. **Don't Repeat Yourself** - The code does two different things depending on the axis of the lines it is drawing, and both these alternatives look very similar. It might be possible to reduce the code duplication here. Doing all these things, we could end up with a method that looks more like calculateLinePosition(); setColor(); drawLine(); and perhaps even extracting setColor() and drawLine() into another method. This would make it much easier to read and understand that the current implementation.                                                                                                                                                                                                                                                                                                                                                                                 |
| drawGrid          | [Link to code](https://github.com/ij222pv/line-chart/blob/b0f67f141fad198fb477fdd02d64fd8aeb015ef1/src/renderers/LineChartRenderer.ts#L238-L256) | 16             | **Don't Repeat Yourself** - This method contains two snippets of code that are nearly identical with just a few arguments changed. I have however already reduced the code duplication of this method by extracting `drawGridLines()` into a separate method. It could be tricky though extracting the duplicated code into a separate method because there are four input arguments that differ between the code snippets. Simply extracting this into a separate method would break against **Function Arguments** The book places emphasis on never using more than three arguments in a method because it would cause confusion about what each argument actually is for. Methods with fewer arguments are easier to comprehend and keep in your mind. So if I were to refactor the duplicated code I should find a way to do it while reducing necessary input arguments. Maybe I could create methods that take an `Axis` as input and return a `Range`, respectively the viewport width or height depending on the supplied `Axis`. Then I would only need to supply a single Axis argument (**Monadic Function**) to the method drawing vertical or horizontal grid lines.                                                                                                                                                                                                                                                                                                                                                                                       |
| drawAxes          | [Link to code](https://github.com/ij222pv/line-chart/blob/b0f67f141fad198fb477fdd02d64fd8aeb015ef1/src/renderers/LineChartRenderer.ts#L91-L111)  | 16             | **Don't Repeat Yourself** - This method is very similar to the previous method with the only difference being it calls `drawAxis()` instead of `drawGridLines()`. I should at least perform the same refactoring suggestions I gave for the previous method, but also consider further deduplication between the `drawAxes()` and `drawGrid()` methods.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| roundTickInterval | [Link to code](https://github.com/ij222pv/line-chart/blob/b0f67f141fad198fb477fdd02d64fd8aeb015ef1/src/renderers/LineChartRenderer.ts#L220-L236) | 14             | **Verbs and Keywords** - Monads, like this method, should be named with the method name and argument forming a verb/noun pair. Right now it looks like `roundTickInterval(value)` which works, but there is room for improvement. Really, the value we are rounding is the tick interval. This also ties in with **Use Descriptive Names** - Currently the method doesn't explain what it is rounded to. At first glance one might believe it is rounded to the nearest integer. To clarify things, we could rename the method to `roundToNiceTickInterval()`. This way we retain the information that the method should round a tick interval, and we also add information about the actual rounding function being performed (rounding to a nice number 0.1, 0.2, 0.5, 1, 2, 5, 10, 20, etc.). **Small!** - As with all these methods, they are quite big and should be shortened. In this method, finding which of three intervals is the closest to the goal interval (lines 227-233) could be extracted into another method `findClosestNumberInArray(number, array)`, or preferably `getClosestNumberInArray` since we already have other methods that use the verb `get` for calculations (**Pick One Word per Concept**). **Dyadic Functions** are slightly more difficult to quickly understand than a **Monadic Function**, but I feel this new method would be justified to have two arguments. I have also named the method to clarify that it takes two arguments and in which order, `Number` and `Array`, according to the **Keyword** function naming. An alternative would be to create another class, `SearchableArray` for example, with a `findClosestNumber` method. |
| drawOutline       | [Link to code](https://github.com/ij222pv/line-chart/blob/b0f67f141fad198fb477fdd02d64fd8aeb015ef1/src/renderers/LineChartRenderer.ts#L46-L61)   | 14             | **Small!** - This method can easily be shortened by 6 lines by simply removing the outline around the edge of the canvas. It's not needed since the canvas already has a border through a CSS stylesheet. **The Stepdown Rule** - The methods should be read like a "top-down narrative" according to the book. This is to make it easy to find the next relevant function when reading the code. Therefore, immediately after the public `render()` method, the `clear()` method should be declared, then any functions `clear()` calls and so on before moving onto the next function in `render()`. I have mistakenly declared `drawOutline()` immediately after `clear()`, when really it should be declared after `drawGrid()` and all its child functions.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |

After refactoring the above methods, they now have the following number of rows:

**drawGridLine:** 3

**drawGrid:** 4

**drawAxes:** 4

**roundTickInterval (now called roundToNiceTickInterval):** 2

**drawOutline:** 2

# Kapitelreflektion kap 3

The book puts emphasis on functions being very small, usually 2-4 lines. This is a lot smaller than I have been used to writing functions previously. But I understand the reasoning behind it. Small functions are easier to read and understand. Also, making sure your functions are written in the same level of abstraction makes it easier to understand. The point is to make functions "transparently obvious" so that they read like a story. I have tried to follow this advice, and a lot of my functions are 4 lines or less, but I still have some functions longer than the recommended, and perhaps slightly exaggerated 4 lines. I have definitely improved the length and abstraction level of my functions compared to my previous coding style.

The book gives very good advice on how to reduce the number of function arguments by for example using member variables or creating a class to combine multiple arguments into one. This also fits in with trying to avoid the code smell "Primitive Obsession", which I don't believe is mentioned in the book, but the point is to create simple classes for storing data like I have done with `Color`, `Point`, `Rectangle` etc. For example, if you need to pass four points, forming a rectangle, into a method, it is better to create a `Rectangle` object that you pass into the method instead. This is done to reduce the number of arguments and increase readability. The book calls this **Argument Objects**.

The advice on **Prefer Exceptions to Returning Error Codes** is helpful as I have occasionally done that in the past. It is difficult to know what is the best approach when there is so much code out there and libraries that don't follow best practices on code quality.

# Reflektion över egen kodkvalitet

The `render` method of `LineChartRenderer` was starting to get long as I was adding more complex rendering logic. I started refactoring it by breaking it down into multiple smaller methods. If I hadn't done this, by the time I finished the module, the `render` method would have been multiple hundred lines long and it would have had a low readability and understandability.

At the start I haven't been commenting my code. The workshop W1 taught me the importance of comments for other people to understand what the code does. Because of this I have made sure to at least comment all the public API methods.

The naming of `getBoundary` in `LineChartState` is a bit confusing. It can be interpreted as either the boundary for the data, or the boundary for the chart area. I have renamed it to `get boundingBoxOfLines`.

At first, all rendering methods in LineChartRenderer took the same two arguments (the rendering context, and the chart state). Those arguments were later replaced with two arguments in the constructor and are stored as private member variables. This makes the rendering methods niladic, rather than dyadic, and thus much easier to understand at a glance.

Previously I had a method `setPoints(Point[])` to choose the points in the graph to render. This works if you only want to render one line. Instead I created an `addLine(Polyline)` method, also replacing `Point[]` with `Polyline` to avoid primitive obsession.

At this point, I am reasonably satisfied with the quality of my code. At least regarding the chapters we have covered in Clean Code so far. I feel like the LineChartRenderer and LineChartState classes are quite large and should be separated into smaller classes. For example, I could create an AxisRenderer and a GridRenderer class to reduce the size of the parent class, just like I have done with the methods. But I am satisfied with my naming of methods and variables, and how I have broken down methods to smaller sizes.

